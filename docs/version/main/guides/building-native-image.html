<!DOCTYPE html>
<html>





<head>
  <title>Building a Native Executable - main - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="default-src https://dpm.demdex.net; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com https://static.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com https://app.mailjet.com http://www.youtube.com http://www.googleadservices.com https://googleads.g.doubleclick.net https://dpm.demdex.net https://giscus.app; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self'; frame-src https://www.googletagmanager.com https://www.youtube.com https://embed.restream.io https://app.mailjet.com https://giscus.app; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/main/guides/building-native-image" />
  <meta property="og:title" content="Building a Native Executable - main" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/building-native-image">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="en" href="https://quarkus.io/version/main/guides/building-native-image" />
  
  <link rel="alternate" hreflang="es" href="https://es.quarkus.io/version/main/guides/building-native-image" />
  
  <link rel="alternate" hreflang="zh" href="https://cn.quarkus.io/version/main/guides/building-native-image" />
  
  <link rel="alternate" hreflang="ja" href="https://ja.quarkus.io/version/main/guides/building-native-image" />
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  

<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
    </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Quarkusとは <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/continuum" class="">リアクティブ</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">学ぶ<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ガイド</a></li>
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">コミュニティ <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="/publications" class="">出版物</a></li>
          <li><a href="/awards" class="">受賞</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/main/guides/building-native-image" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://es.quarkus.io/version/main/guides/building-native-image">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/main/guides/building-native-image">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/main/guides/building-native-image">日本語</a></li>
          </ul>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    



<div class="full-width-version-bg grey align-self">
  <div class="grid-wrapper">
    <div class="grid__item width-6-12">
      <p class="returnlink"><i class="fas fa-angle-left"></i><a href="/version/main/guides/">ガイド一覧に戻る</a></p>
    </div>
    <div class="grid__item width-6-12 align-self-center text-right hide-mobile">
      <label id="guide-version-label">ガイドのバージョンを選択</label>
      <select id="guide-version-dropdown">
        
      
        
        
        
        
          
        <option value="main" selected>Main - SNAPSHOT</option>
        
        
      
        
        
        
        
          
        <option value="latest" >2.12 - Latest</option>
        
        
      
        
        
        
        
          
        <option value="2.7" >2.7</option>
        
        
      
        
        
        
        
          
        <option value="2.2" >2.2</option>
        
        
      
        
        
        
        
          
        <option value="1.11" >1.11</option>
        
        
      
    
      </select>
    </div>
  </div>
</div>

<div class="grid-wrapper guide">
  <div class="grid__item width-12-12 width-12-12-mobile">
    <h1 class="text-caps">Building a Native Executable </h1>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#graalvm">GraalVM</a></li>
<li><a href="#前提条件">前提条件</a>
<ul class="sectlevel2">
<li><a href="#configuring-graalvm">Configuring GraalVM</a></li>
</ul>
</li>
<li><a href="#ソリューション">ソリューション</a></li>
<li><a href="#ネイティブ実行可能ファイルの生成">ネイティブ実行可能ファイルの生成</a>
<ul class="sectlevel2">
<li><a href="#build-fully-static-native-executables">Build fully static native executables</a></li>
</ul>
</li>
<li><a href="#ネイティブ実行可能ファイルのテスト">ネイティブ実行可能ファイルのテスト</a>
<ul class="sectlevel2">
<li><a href="#プロファイル">プロファイル</a></li>
<li><a href="#java-preview-features">Java preview features</a></li>
<li><a href="#ネイティブ実行可能ファイルとして実行している場合のテストの除外">ネイティブ実行可能ファイルとして実行している場合のテストの除外</a></li>
<li><a href="#既存のネイティブ実行可能ファイルのテスト">既存のネイティブ実行可能ファイルのテスト</a></li>
</ul>
</li>
<li><a href="#container-runtime">Creating a Linux executable without GraalVM installed</a></li>
<li><a href="#コンテナーの作成">コンテナーの作成</a>
<ul class="sectlevel2">
<li><a href="#コンテナーイメージのエクステンションの使用">コンテナーイメージのエクステンションの使用</a></li>
<li><a href="#マイクロベースイメージを手動で使用する方法">マイクロベースイメージを手動で使用する方法</a></li>
<li><a href="#最小限のベースイメージを手動で使用する方法">最小限のベースイメージを手動で使用する方法</a></li>
<li><a href="#multistage-docker">マルチステージDockerビルドの使用</a></li>
<li><a href="#using-a-distroless-base-image">Using a Distroless base image</a></li>
<li><a href="#スクラッチベースイメージの使用">スクラッチベースイメージの使用</a></li>
<li><a href="#ネイティブ実行可能ファイルの圧縮">ネイティブ実行可能ファイルの圧縮</a></li>
<li><a href="#separating-java-and-native-image-compilation">Separating Java and native image compilation</a></li>
</ul>
</li>
<li><a href="#ネイティブ実行可能ファイルのデバッグ">ネイティブ実行可能ファイルのデバッグ</a></li>
<li><a href="#configuration-reference">ネイティブ実行可能ファイルの設定</a></li>
<li><a href="#次のステップ">次のステップ</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このガイドでは以下をカバーしています:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アプリケーションをネイティブ実行可能ファイルにコンパイル</p>
</li>
<li>
<p>ネイティブ実行可能ファイルのコンテナーへのパッケージング</p>
</li>
<li>
<p>ネイティブ実行可能ファイルのデバッグ</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>このガイドは、<a href="getting-started">入門ガイド</a> で開発されたアプリケーションを入力としています。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="graalvm"><a class="anchor" href="#graalvm"></a>GraalVM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ネイティブな実行可能ファイルをビルドするには、GraalVM のディストリビューションを使用する必要があります。ディストリビューションは3つあります。Oracle GraalVM Community Edition (CE)、Oracle GraalVM Enterprise Edition (EE)、そして Mandrel です。Oracle ディストリビューションと Mandrel ディストリビューションの違いは以下の通りです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mandrelは、Oracle GraalVM CEのダウンストリームディストリビューションです。Mandrelの主な目的は、Quarkusをサポートするために特別に設計されたネイティブ実行可能ファイルを構築する方法を提供することです。</p>
</li>
<li>
<p>Mandrel のリリースは、アップストリームのOracle GraalVM CEコードベースから派生したコードベースから構築されており、わずかな変更しか行われていませんが、Quarkusネイティブアプリには必要ない重要な除外事項がいくつかあります。これらのリリースは、Oracle GraalVM CEと同じ機能をサポートしており、機能に大きな変更はありません。特筆すべきは、多言語プログラミングのサポートが含まれていないことです。これらの除外の理由は、大多数のQuarkusユーザーにより良いレベルのサポートを提供するためです。また、これらの除外は、Oracle GraalVM CE/EEと比較して、Mandrelの配布サイズが大幅に縮小されていることを意味しています。</p>
</li>
<li>
<p>Mandrel is built slightly differently to Oracle GraalVM CE, using the standard OpenJDK project. This means that it does not profit from a few small enhancements that Oracle have added to the version of OpenJDK used to build their own GraalVM downloads. These enhancements are omitted because upstream OpenJDK does not manage them, and cannot vouch for. This is particularly important when it comes to conformance and security.</p>
</li>
<li>
<p>Mandrelは現在のところ、Linuxのコンテナ化された環境をターゲットとしたネイティブ実行ファイルのビルドにのみ推奨されています。つまり、Mandrelユーザーは、コンテナを使用してネイティブ実行可能ファイルを構築することが推奨されます。macOS用のネイティブ実行ファイルをビルドする場合、Mandrelは現在そのプラットフォームをターゲットにしていないため、代わりにOracle GraalVMの使用を検討するべきです。ベアメタルのLinux上で直接ネイティブ実行可能ファイルをビルドすることも可能です。詳細は <a href="https://github.com/graalvm/mandrel/blob/default/README.md">Mandrel README</a> and <a href="https://github.com/graalvm/mandrel/releases">Mandrel のリリース</a>を参照してください。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="前提条件"><a class="anchor" href="#前提条件"></a>前提条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>約15分</p>
</li>
<li>
<p>An IDE</p>
</li>
<li>
<p>JDK 11+ がインストールされ、 <code>JAVA_HOME</code> が適切に設定されていること</p>
</li>
<li>
<p>Apache Maven 3.8.1+</p>
</li>
<li>
<p>A working container runtime (Docker or <a href="podman">Podman</a>)</p>
</li>
<li>
<p>使用したい場合、 <a href="cli-tooling.html">Quarkus CLI</a></p>
</li>
<li>
<p>Mandrel or GraalVM installed and <a href="#configuring-graalvm">configured appropriately</a></p>
</li>
<li>
<p><a href="#configuring-c-development">動作するC言語の開発環境</a></p>
</li>
<li>
<p><a href="getting-started.html">入門ガイド</a>で開発したアプリケーションのコード</p>
</li>
</ul>
</div>
<div id="configuring-c-development" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Supporting native compilation in C</div>
<div class="paragraph">
<p>動作するC言語の開発環境があるとはどういう意味でしょうか?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linuxでは、GCC、glibc、zlibヘッダが必要です。一般的なディストリビューションでは次の通りです:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># dnf (rpm-based)
sudo dnf install gcc glibc-devel zlib-devel libstdc++-static
# Debian-based distributions:
sudo apt-get install build-essential libz-dev zlib1g-dev</code></pre>
</div>
</div>
</li>
<li>
<p>macOS では、XCode が必要な依存関係を提供します:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">xcode-select --install</code></pre>
</div>
</div>
</li>
<li>
<p>Windowsの場合は、 <a href="https://aka.ms/vs/15/release/vs_buildtools.exe">Visual Studio 2017 Visual C++ Build Tools</a> をインストールする必要があります。</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="configuring-graalvm"><a class="anchor" href="#configuring-graalvm"></a>Configuring GraalVM</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>GraalVMをインストールできない場合は、マルチステージのDockerビルドを使用して、GraalVMを含むDockerコンテナー内でMavenを実行することができます。このガイドの最後にこれを行う方法の説明があります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Version 22.0.0 が必要です。コミュニティエディションで大丈夫です。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>まだの場合は、GraalVM をインストールします。これにはいくつかのオプションがあります:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/graalvm/mandrel/releases" class="bare">https://github.com/graalvm/mandrel/releases</a> または <a href="https://github.com/graalvm/graalvm-ce-builds/releases" class="bare">https://github.com/graalvm/graalvm-ce-builds/releases</a> から適切なアーカイブをダウンロードし、他の JDK と同じように解凍します。</p>
</li>
<li>
<p><a href="https://sdkman.io/jdks#Oracle">sdkman</a>、 <a href="https://github.com/graalvm/homebrew-tap">homebrew</a>、 <a href="https://github.com/ScoopInstaller/Java">scoop</a> など、プラットフォーム固有のインストールツールを使用してください。</p>
</li>
</ul>
</div>
</li>
<li>
<p>ランタイム環境を構成します。 <code>GRAALVM_HOME</code> 環境変数をGraalVMインストールディレクトリーに設定します。例えば、</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export GRAALVM_HOME=$HOME/Development/graalvm/</code></pre>
</div>
</div>
<div class="paragraph">
<p>macOS (Mandrel ではサポート対象外) では、変数を <code>Home</code> のサブディレクトリに指定します:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export GRAALVM_HOME=$HOME/Development/graalvm/Contents/Home/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Windowsでは、コントロールパネルから環境変数を設定する必要があります。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>scoop でインストールすれば自動的に設定されます。</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>(Oracle GraalVM CE/EE の場合のみ) <code>gu install</code> を使用して <code>native-image</code> ツールをインストールします。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">${GRAALVM_HOME}/bin/gu install native-image</code></pre>
</div>
</div>
<div class="paragraph">
<p>GraalVMの以前のリリースでは、デフォルトで <code>native-image</code> ツールが含まれていました。現在はそのようになっておらず、GraalVM自体をインストールした後の第二ステップとしてインストールする必要があります。注意: #graal-and-catalina[macOS CatalinaでGraalVMを使用する]際に、未解決の問題が発生しています。</p>
</div>
</li>
<li>
<p>(オプション) 環境変数 <code>JAVA_HOME</code> を GraalVM のインストールディレクトリーに設定します。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export JAVA_HOME=${GRAALVM_HOME}</code></pre>
</div>
</div>
</li>
<li>
<p>(オプション) GraalVM <code>bin</code> ディレクトリーをパスに追加します。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export PATH=${GRAALVM_HOME}/bin:$PATH</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="graal-and-catalina" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">macOS CatalinaでGraalVMを使用している場合の問題</div>
<div class="paragraph">
<p>この <a href="https://github.com/oracle/graal/issues/1724">GraalVMの問題</a>で報告されているように、GraalVMバイナリーは(まだ)macOS Catalinaに対して認証されていません。これは、<code>gu</code> 使用時に次のエラーが表示される可能性があることを意味します:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">“gu” cannot be opened because the developer cannot be verified</code></pre>
</div>
</div>
<div class="paragraph">
<p>回避策として、次のコマンドを使用して、GraalVMインストールディレクトリー上の <code>com.apple.quarantine</code> 拡張属性を再帰的に削除します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">xattr -r -d com.apple.quarantine ${GRAALVM_HOME}/../..</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ソリューション"><a class="anchor" href="#ソリューション"></a>ソリューション</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次のセクションの手順に従って、アプリケーションを段階的にパッケージ化することをお勧めします。しかしながら、完成したサンプルに直接進むこともできます。</p>
</div>
<div class="paragraph">
<p>Gitレポジトリをクローンするか <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code> 、 <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip">アーカイブ</a> をダウンロードします。</p>
</div>
<div class="paragraph">
<p>ソリューションは <code>getting-started</code> ディレクトリーに存在します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ネイティブ実行可能ファイルの生成"><a class="anchor" href="#ネイティブ実行可能ファイルの生成"></a>ネイティブ実行可能ファイルの生成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>アプリケーションのネイティブ実行可能ファイルには、アプリケーション・コード、必要なライブラリ、Java API、および VM の縮小版が含まれます。VM ベースが小さくなることで、アプリケーションの起動時間が改善され、ディスクフットプリントが最小限に抑えられます。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/native-executable-process.png" alt="ネイティブ実行可能ファイルの生成"></span></p>
</div>
<div class="paragraph">
<p>前回のチュートリアルでアプリケーションを生成した場合は、 <code>pom.xml</code> に以下の <em>プロファイル</em> があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;profiles&gt;
    &lt;profile&gt;
        &lt;id&gt;native&lt;/id&gt;
        &lt;properties&gt;
            &lt;quarkus.package.type&gt;native&lt;/quarkus.package.type&gt;
        &lt;/properties&gt;
    &lt;/profile&gt;
&lt;/profiles&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>&lt;quarkus.native.additional-build-args&gt;</code> プロパティーを使用して、 <code>native-image</code> コマンドにカスタムオプションを指定できます。複数のオプションはカンマで区切ることができます。</p>
</div>
<div class="paragraph">
<p>もう一つの可能性は、 <code>application.properties</code> に <code>quarkus.native.additional-build-args</code> 設定プロパティーを含めることです。</p>
</div>
<div class="paragraph">
<p>ネイティブイメージビルド処理の設定方法については、以下の <a href="#設定リファレンス">[設定リファレンス]</a> の項で詳しく説明しています。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>プロファイルを使用しているのは、すぐにわかると思いますが、ネイティブ実行可能ファイルをパッケージ化するのに <em>数</em> 分かかるからです。コマンドラインのプロパティーとして -Dquarkus.package.type=native を渡すだけでもいいのですが、プロファイルを使う方がいいでしょう。</p>
</div>
<div class="paragraph">
<p>Create a native executable using:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.package.type=native</code></pre>
</div>
</div>
<div id="graal-and-windows" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Issues with packaging on Windows</div>
<div class="paragraph">
<p>Visual Studio の Microsoft Native Tools はパッケージングを行う前に、初期化する必要があります。これは、Visual Studio ビルドツールと一緒にインストールされた <code>x64 Native Tools Command Prompt</code> を起動することで行うことができます。 <code>x64 Native Tools Command Prompt</code> で、プロジェクト・フォルダーに移動して <code>mvnw package -Pnative</code> を実行してください。</p>
</div>
<div class="paragraph">
<p>もう一つのソリューションは、これを行うためのスクリプトを書くことです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cmd /c 'call "C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build\vcvars64.bat" &amp;&amp; mvn package -Pnative'</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>通常のファイルに加えて、このビルドでは <code>target/getting-started-1.0-SNAPSHOT-runner</code> を生成します。これを実行するには、次のようにします: <code>./target/getting-started-1.0-SNAPSHOT-runner</code> .</p>
</div>
<div id="graal-package-preview" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Java preview features</div>
<div class="paragraph">
<p>プレビュー機能に依存する Java コードには、特別な注意が必要です。これは、ネイティブ実行可能ファイルを生成する場合、<code>--enable-preview</code> フラグを基になるネイティブイメージ呼び出しに渡す必要があることを意味します。そのためには、フラグの前に <code>-J</code> を付け、それを追加のネイティブビルド引数として渡します: <code>-Dquarkus.native.additional-build-args=-J&#8212;&#8203;enable-preview</code> 。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="build-fully-static-native-executables"><a class="anchor" href="#build-fully-static-native-executables"></a>Build fully static native executables</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
完全に静的なネイティブ実行可能ファイルのサポートは実験的なものです。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On Linux it&#8217;s possible to package a native executable that doesn&#8217;t depend on any system shared library. There are <a href="https://www.graalvm.org/22.1/reference-manual/native-image/StaticImages/#preparation">some system requirements</a> to be fulfilled and additional build arguments to be used along with the <code>native-image</code> invocation, a minimum is <code>-Dquarkus.native.additional-build-args="--static","--libc=musl"</code>.</p>
</div>
<div class="paragraph">
<p>Compiling fully static binaries is done by statically linking <a href="https://musl.libc.org/">musl</a> instead of <code>glibc</code> and should not be used in production without rigorous testing.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ネイティブ実行可能ファイルのテスト"><a class="anchor" href="#ネイティブ実行可能ファイルのテスト"></a>ネイティブ実行可能ファイルのテスト</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Producing a native executable can lead to a few issues, and so it&#8217;s also a good idea to run some tests against the application running in the native file. The reasoning is explained in the <a href="getting-started-testing#quarkus-integration-test">Testing Guide</a>.</p>
</div>
<div class="paragraph">
<p>To see the <code>GreetingResourceIT</code> run against the native executable, use <code>./mvnw verify -Pnative</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">$ ./mvnw verify -Pnative
...
[getting-started-1.0.0-SNAPSHOT-runner:18820]     universe:     587.26 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]      (parse):   2,247.59 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]     (inline):   1,985.70 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]    (compile):  14,922.77 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]      compile:  20,361.28 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]        image:   2,228.30 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]        write:     364.35 ms
[getting-started-1.0.0-SNAPSHOT-runner:18820]      [total]:  52,777.76 ms
[INFO]
[INFO] --- maven-failsafe-plugin:2.22.1:integration-test (default) @ getting-started ---
[INFO]
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.acme.quickstart.GreetingResourceIT
Executing [/data/home/gsmet/git/quarkus-quickstarts/getting-started/target/getting-started-1.0.0-SNAPSHOT-runner, -Dquarkus.http.port=8081, -Dtest.url=http://localhost:8081, -Dquarkus.log.file.path=build/quarkus.log]
2019-04-15 11:33:20,348 INFO  [io.quarkus] (main) Quarkus 999-SNAPSHOT started in 0.002s. Listening on: http://[::]:8081
2019-04-15 11:33:20,348 INFO  [io.quarkus] (main) Installed features: [cdi, resteasy-reactive]
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.387 s - in org.acme.quickstart.GreetingResourceIT
...</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>デフォルトでは、Quarkusはネイティブテストを開始し、自動的に失敗するまでに60秒待機します。この時間は、<code>quarkus.test.wait-time</code> システムプロパティーを使用して変更できます。たとえば、待機時間を300秒に増やすには、<code>./mvnw verify -Pnative -Dquarkus.test.wait-time=300</code> となります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>この手順は、以前は <code>@NativeImageTest</code> アノテーションを使用して実行されていました。<code>@NativeImageTest</code> の廃止と、<code>@NativeImageTest</code> のテスト機能のスーパーセットを提供する <code>@QuarkusIntegrationTest</code> の採用が検討されています。<code>@QuarkusIntegrationTest</code> の詳細については、<a href="getting-started-testing#quarkus-integration-test">アプリケーションのテスト</a> を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="プロファイル"><a class="anchor" href="#プロファイル"></a>プロファイル</h3>
<div class="paragraph">
<p>デフォルトでは、インテグレーションテストは <code>prod</code> プロファイルを使用して、ネイティブの実行ファイルに対して <strong>build</strong> と <strong>run</strong> の両方を行います。</p>
</div>
<div class="paragraph">
<p>You can override the profile the executable <strong>runs</strong> with during the test using the <code>quarkus.test.native-image-profile</code> property. Either by adding it to <code>application.properties</code> or by appending it to the command line: <code>./mvnw verify -Pnative -Dquarkus.test.native-image-profile=test</code>. Your <code>%test.</code> prefixed properties will be used at the test runtime.</p>
</div>
<div class="paragraph">
<p>You can override the profile the executable is <strong>built</strong> with and <strong>runs</strong> with using the <code>quarkus-profile=test</code> property, e.g. <code>./mvnw clean verify -Pnative -Dquarkus-profile=test</code>. This might come handy if there are test specific resources to be processed, such as importing test data into the database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.native.resources.includes=version.txt
%test.quarkus.native.resources.includes=version.txt,import-dev.sql
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.hibernate-orm.sql-load-script=import-dev.sql</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the aforementioned example in your <code>application.properties</code>, your Hibernate ORM managed database will be populated with test data both during the JVM mode test run and during the native mode test run. The production executable will contain only the <code>version.txt</code> resource, no superfluous test data.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The executable built with <code>-Dquarkus-profile=test</code> is not suitable for production deployment. It contains your test resources files and settings. Once the testing is done, the executable would have to be built again, using the default, <code>prod</code> profile.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="java-preview-features"><a class="anchor" href="#java-preview-features"></a>Java preview features</h3>
<div id="graal-test-preview" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Java preview features</div>
<div class="paragraph">
<p>プレビュー機能に依存する Java コードには、特別な注意が必要です。つまり、ネイティブ実行可能ファイルをテストする場合は、<code>--enable-preview</code> フラグを Surefire プラグインに渡す必要があります。その方法の 1 つが、<code>&lt;argLine&gt;--enable-preview&lt;/argLine&gt;</code> を <code>configuration</code> セクションに追加する方法です。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ネイティブ実行可能ファイルとして実行している場合のテストの除外"><a class="anchor" href="#ネイティブ実行可能ファイルとして実行している場合のテストの除外"></a>ネイティブ実行可能ファイルとして実行している場合のテストの除外</h3>
<div class="paragraph">
<p>この方法でテストを実行する場合、実際にネイティブで実行されるのはアプリケーションのエンドポイントのみで、HTTP 呼び出しでしかテストできません。テストコードは実際にはネイティブには実行されないので、HTTP エンドポイントを呼び出さないコードをテストしている場合は、ネイティブテストの一部として実行するのは良い考えではないでしょう。</p>
</div>
<div class="paragraph">
<p>If you share your test class between JVM and native executions like we advise above, you can mark certain tests with the <code>@DisabledOnIntegrationTest</code> annotation in order to skip them when testing against a native image.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using <code>@DisabledOnIntegrationTest</code> will also disable the test in all integration test instances, including testing the application in JVM mode, in a container image, and native image.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="既存のネイティブ実行可能ファイルのテスト"><a class="anchor" href="#既存のネイティブ実行可能ファイルのテスト"></a>既存のネイティブ実行可能ファイルのテスト</h3>
<div class="paragraph">
<p>It is also possible to re-run the tests against a native executable that has already been built. To do this run <code>./mvnw test-compile failsafe:integration-test -Pnative</code>. This will discover the existing native image and run the tests against it using failsafe.</p>
</div>
<div class="paragraph">
<p>何らかの理由でプロセスがネイティブイメージを見つけられない場合や、ターゲットディレクトリーにないネイティブイメージをテストしたい場合は、 <code>-Dnative.image.path=</code> システムプロパティーで実行ファイルを指定することができます。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="container-runtime"><a class="anchor" href="#container-runtime"></a>Creating a Linux executable without GraalVM installed</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
先に進む前に、コンテナーランタイム(Docker、podman)の動作環境が整っていることを確認しておきましょう。WindowsでDockerを使用している場合は、Docker Desktopのファイル共有設定でプロジェクトのドライブを共有し、Docker Desktopを再起動する必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>多くの場合、Quarkusアプリケーション用のネイティブLinux実行ファイルを作成する必要があります(例えば、コンテナー化された環境で実行するためなど)、このタスクを達成するために適切なGraalVMバージョンをインストールする手間を省きたいと考えています(例えば、CI環境では、できるだけ少ないソフトウェアをインストールするのが一般的です)。</p>
</div>
<div class="paragraph">
<p>このため、Quarkusでは、Dockerやpodmanなどのコンテナーランタイムを利用して、ネイティブのLinux実行ファイルを作成する非常に便利な方法を提供しています。このタスクを達成する最も簡単な方法は、次を実行することです:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native --no-tests -Dquarkus.native.container-build=true
# The --no-tests flag is required only on Windows and macOS.</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative -DskipTests -Dquarkus.native.container-build=true</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.package.type=native -Dquarkus.native.container-build=true</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, Quarkus automatically detects the container runtime. If you want to explicitly select the container runtime, you can do it with:</p>
</div>
<div class="paragraph">
<p>For Docker:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native -Dquarkus.native.container-build=true -Dquarkus.native.container-runtime=docker</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative -Dquarkus.native.container-build=true -Dquarkus.native.container-runtime=docker</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.package.type=native -Dquarkus.native.container-build=true -Dquarkus.native.container-runtime=docker</code></pre>
</div>
</div>
<div class="paragraph">
<p>podman の場合:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native -Dquarkus.native.container-build=true -Dquarkus.native.container-runtime=podman</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative -Dquarkus.native.container-build=true -Dquarkus.native.container-runtime=podman</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.package.type=native -Dquarkus.native.container-build=true -Dquarkus.native.container-runtime=podman</code></pre>
</div>
</div>
<div class="paragraph">
<p>これらは通常のQuarkusの設定プロパティーなので、常にコンテナーでビルドしたい場合は、毎回指定しなくて済むように、 <code>application.properties</code> に追加することをお勧めします。</p>
</div>
</td>
</tr>
</table>
</div>
<div id="tip-quarkus-native-remote-container-build" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JARが正常にビルドされているにもかかわらず、コンテナビルドでネイティブ実行可能ファイルを作成しようとすると、アプリケーションJARに対して以下のようなinvalid pathエラーが表示される場合は、コンテナランタイムにリモートデーモンを使用している可能性があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Error: Invalid Path entry getting-started-1.0.0-SNAPSHOT-runner.jar
Caused by: java.nio.file.NoSuchFileException: /project/getting-started-1.0.0-SNAPSHOT-runner.jar</pre>
</div>
</div>
<div class="paragraph">
<p>この場合、パラメータ <code>-Dquarkus.native.container-build=true</code> の代わりに <code>-Dquarkus.native.remote-container-build=true</code> を使用してください。</p>
</div>
<div class="paragraph">
<p>その理由は、 <code>-Dquarkus.native.container-build=true</code> を通して起動されるローカルビルドドライバは、ビルドコンテナで JAR を利用できるようにするためにボリュームマウントを使用しますが、ボリュームマウントはリモートデーモンでは機能しません。リモートコンテナのビルドドライバは、必要なファイルをマウントするのではなく、コピーします。リモートドライバはローカルデーモンでも動作しますが、ローカルの場合はローカルドライバを使用した方が良いことに注意してください。なぜなら、マウントの方がコピーよりもパフォーマンスが高いからです。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Building with Mandrel requires a custom builder image parameter to be passed additionally:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native -Dquarkus.native.container-build=true -Dquarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel:22.0-java11</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative -Dquarkus.native.container-build=true -Dquarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel:22.0-java11</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.package.type=native -Dquarkus.native.container-build=true -Dquarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel:22.0-java11</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記のコマンドはフローティングタグを指していることに注意してください。ビルダーイメージを最新かつ安全に保つために、フローティングタグを使用することを強く推奨します。どうしても必要な場合は、特定のタグをハードコーディングしても構いませんが(利用可能なタグについては <a href="https://quay.io/repository/quarkus/ubi-quarkus-mandrel?tab=tags">こちら</a>を参照してください)、その方法ではセキュリティーアップデートが受けられず、サポートされていないことに注意してください。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="コンテナーの作成"><a class="anchor" href="#コンテナーの作成"></a>コンテナーの作成</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="コンテナーイメージのエクステンションの使用"><a class="anchor" href="#コンテナーイメージのエクステンションの使用"></a>コンテナーイメージのエクステンションの使用</h3>
<div class="paragraph">
<p>Quarkusアプリケーションからコンテナーイメージを作成する最も簡単な方法は、コンテナーイメージ エクステンションの1つを利用することです。</p>
</div>
<div class="paragraph">
<p>これらのエクステンションのいずれかが存在する場合、ネイティブ実行可能ファイル用のコンテナーイメージを作成することは、基本的には単一のコマンドを実行することになります:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw package -Pnative -Dquarkus.native.container-build=true -Dquarkus.container-image.build=true</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.native.container-build=true</code> では GraalVM がインストールされていなくても Linux の実行ファイルを作成することができます(ローカルに GraalVM がインストールされていない場合や、ローカルのオペレーティングシステムが Linux ではない場合にのみ必要です)。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you&#8217;re running a remote Docker daemon, you need to replace <code>quarkus.native.container-build=true</code> with <code>quarkus.native.remote-container-build=true</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="#tip-quarkus-native-remote-container-build">Creating a Linux executable without GraalVM installed</a> for more details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.container-image.build=true</code> 最終的なアプリケーションアーティファクト(この場合はネイティブ実行可能ファイル)を使用してコンテナーイメージを作成するようにQuarkusに指示します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>詳細については、 <a href="container-image">コンテナイメージガイド</a> を参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="マイクロベースイメージを手動で使用する方法"><a class="anchor" href="#マイクロベースイメージを手動で使用する方法"></a>マイクロベースイメージを手動で使用する方法</h3>
<div class="paragraph">
<p>Quarkus Mavenプラグインで生成されたJARを使用して、コンテナー内でアプリケーションを実行することができます。ただし、このセクションでは、生成されたネイティブ実行可能ファイルを使用してコンテナーイメージを作成することに焦点を当てます。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/containerization-process.png" alt="Containerization Process"></span></p>
</div>
<div class="paragraph">
<p>ローカルのGraalVMインストール環境を使用する場合、ネイティブ実行可能ファイルは、ローカルのオペレーティングシステム(Linux、macOS、Windowsなど)をターゲットにしています。しかし、コンテナーはオペレーティングシステムによって生成されたものと同じ <em>実行</em> 形式を使用しない場合があるため、コンテナーランタイムを活用して実行形式を生成するようにMavenビルドに指示します(この <a href="#container-runtime">セクション</a> で説明されているように)。</p>
</div>
<div class="paragraph">
<p>生成される実行ファイルは 64 ビットの Linux 実行ファイルになるので、お使いの OS によっては実行できなくなる可能性があります。しかし、コンテナにコピーするので問題ありません。プロジェクト生成では、 <code>src/main/docker</code> ディレクトリに <code>Dockerfile.native-micro</code> を用意し、以下のような内容にしています:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM quay.io/quarkus/quarkus-micro-image:1.0
WORKDIR /work/
COPY target/*-runner /work/application
RUN chmod 775 /work
EXPOSE 8080
CMD ["./application", "-Dquarkus.http.host=0.0.0.0"]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Quarkus マイクロイメージとは？</div>
<div class="paragraph">
<p>Quarkus マイクロイメージは、ネイティブアプリケーションを実行するための適切な依存関係のセットを提供する小さなコンテナイメージです。これは <a href="https://catalog.redhat.com/software/containers/ubi8-micro/601a84aadd19c7786c47c8ea?container-tabs=overview">UBI Micro</a> に基づいています。このベースイメージは、コンテナで完全に機能するように調整されています。</p>
</div>
<div class="paragraph">
<p>You can read more about UBI images on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.redhat.com/en/blog/introducing-red-hat-universal-base-image">Introduction to Universal Base Image</a></p>
</li>
<li>
<p><a href="https://catalog.redhat.com/software/container-stacks/detail/5ec53f50ef29fd35586d9a56">Red Hat Universal Base Image 8</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>UBI イメージは制限なく使用できます。</p>
</div>
<div class="paragraph">
<p><a href="quarkus-runtime-base-image">このページ</a> では、アプリケーションに特定の要件がある場合に、<code>quarkus-micro</code> イメージを拡張する方法について説明しています。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>あとは、生成されたネイティブ実行可能ファイルを削除していなければ、dockerイメージを使ってビルドします:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker build -f src/main/docker/Dockerfile.native -t quarkus-quickstart/getting-started .</code></pre>
</div>
</div>
<div class="paragraph">
<p>そして最後に、以下を実行します:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -i --rm -p 8080:8080 quarkus-quickstart/getting-started</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="最小限のベースイメージを手動で使用する方法"><a class="anchor" href="#最小限のベースイメージを手動で使用する方法"></a>最小限のベースイメージを手動で使用する方法</h3>
<div class="paragraph">
<p>プロジェクト生成では、以下の内容の ` src/main/docker docker` ディレクトリも提供されます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM registry.access.redhat.com/ubi8/ubi-minimal:8.5
WORKDIR /work/
COPY target/*-runner /work/application
RUN chmod 775 /work
EXPOSE 8080
CMD ["./application", "-Dquarkus.http.host=0.0.0.0"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>UBI の最小イメージは、上記のマイクロイメージよりも大きくなっています。これには、<code>microdnf</code> パッケージマネージャーなどのユーティリティーが含まれています。</p>
</div>
</div>
<div class="sect2">
<h3 id="multistage-docker"><a class="anchor" href="#multistage-docker"></a>マルチステージDockerビルドの使用</h3>
<div class="paragraph">
<p>前のセクションでは、Maven または Gradle を使用してネイティブ実行可能ファイルをビルドする方法を示しましたが、その場合は最初にネイティブ実行可能ファイルを作成しておく必要があります。さらに、このネイティブ実行可能ファイルは Linux64 ビットの実行可能ファイルである必要があります。</p>
</div>
<div class="paragraph">
<p>ビルドツールを含む最終的なコンテナを用意せずに、ネイティブ実行可能ファイルをコンテナに直接ビルドする必要がある場合もあるはずです。このアプローチは、マルチステージの Docker ビルドで使用可能です:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>最初の段階では、Maven または Gradle を使用してネイティブ実行可能ファイルをビルドします</p>
</li>
<li>
<p>第 2 段階は、生成されたネイティブ実行可能ファイルをコピーする最小限のイメージです</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>このような多段階を用いたビルドは、次のように実現できます:</p>
</div>
<div class="paragraph">
<p>MavenでビルドするためのサンプルDockerfileです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">## Stage 1 : build with maven builder image with native capabilities
FROM quay.io/quarkus/ubi-quarkus-native-image:22.0.0-java11 AS build
COPY --chown=quarkus:quarkus mvnw /code/mvnw
COPY --chown=quarkus:quarkus .mvn /code/.mvn
COPY --chown=quarkus:quarkus pom.xml /code/
USER quarkus
WORKDIR /code
RUN ./mvnw -B org.apache.maven.plugins:maven-dependency-plugin:3.1.2:go-offline
COPY src /code/src
RUN ./mvnw package -Pnative

## Stage 2 : create the docker final image
FROM quay.io/quarkus/quarkus-micro-image:1.0
WORKDIR /work/
COPY --from=build /code/target/*-runner /work/application

# set up permissions for user `1001`
RUN chmod 775 /work /work/application \
  &amp;&amp; chown -R 1001 /work \
  &amp;&amp; chmod -R "g+rwX" /work \
  &amp;&amp; chown -R 1001:root /work

EXPOSE 8080
USER 1001

CMD ["./application", "-Dquarkus.http.host=0.0.0.0"]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
このマルチステージ Docker ビルドは、ホストマシンから Maven ラッパーをコピーします。Maven ラッパー (または Gradle ラッパー) は、特定のバージョンの Maven/Gradle を提供するための便利な方法です。Maven と Gradle を使用してベースイメージを作成する必要がなくなります。プロジェクトで Maven ラッパーをプロビジョニングするには、<code>mvn -N org.apache.maven.plugins:maven-wrapper-plugin:3.1.0:wrapper</code> を使用します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>このファイルは、Getting started quickstartには含まれていないので、 <code>src/main/docker/Dockerfile.multistage</code> に保存してください。</p>
</div>
<div class="paragraph">
<p>GradleでビルドするためのサンプルDockerfileです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">## Stage 1 : build with maven builder image with native capabilities
FROM quay.io/quarkus/ubi-quarkus-native-image:22.0.0-java11 AS build
USER root
RUN microdnf install findutils
COPY --chown=quarkus:quarkus gradlew /code/gradlew
COPY --chown=quarkus:quarkus gradle /code/gradle
COPY --chown=quarkus:quarkus build.gradle /code/
COPY --chown=quarkus:quarkus settings.gradle /code/
COPY --chown=quarkus:quarkus gradle.properties /code/
USER quarkus
WORKDIR /code
COPY src /code/src
RUN ./gradlew build -Dquarkus.package.type=native

## Stage 2 : create the docker final image
FROM quay.io/quarkus/quarkus-micro-image:1.0
WORKDIR /work/
COPY --from=build /code/build/*-runner /work/application
RUN chmod 775 /work
EXPOSE 8080
CMD ["./application", "-Dquarkus.http.host=0.0.0.0"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>プロジェクトでGradleを使用している場合は、このサンプルDockerfileを使用することができます。 <code>src/main/docker/Dockerfile.multistage</code> に保存してください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dockerビルドを起動する前に、デフォルトの <code>.dockerignore</code> ファイルを更新する必要があります。これは、<code>target</code> ディレクトリ以のすべてがフィルタリングされるためです。コンテナ内にビルドする予定であるため、<code>src</code> ディレクトリをコピーする必要があります。そのために、<code>.dockerignore</code> を編集し、その内容を更新します。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker build -f src/main/docker/Dockerfile.multistage -t quarkus-quickstart/getting-started .</code></pre>
</div>
</div>
<div class="paragraph">
<p>最後に、以下を実行します:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -i --rm -p 8080:8080 quarkus-quickstart/getting-started</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>ネイティブ実行可能ファイルにSSLサポートが必要な場合は、Dockerイメージに必要なライブラリを簡単に含めることができます。</p>
</div>
<div class="paragraph">
<p>詳しくは <a href="native-and-ssl#working-with-containers">ネイティブ実行可能ファイルでのSSL利用ガイド</a> を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
GraalVM CE の代わりに Mandrel を使用するには、<code>FROM</code> 句を <code>FROM quay.io/quarkus/ubi-quarkus-mandrel:$TAG AS build</code> に更新します。<code>$TAG</code> は、 <a href="https://quay.io/repository/quarkus/ubi-quarkus-mandrel?tab=tags">Quarkus Mandrel イメージタグのページ</a> にあります。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-a-distroless-base-image"><a class="anchor" href="#using-a-distroless-base-image"></a>Using a Distroless base image</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Distroless イメージのサポートは実験的なものです。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>小さなコンテナイメージを探している場合は、 <a href="https://github.com/GoogleContainerTools/distroless">distroless</a> アプローチでベースレイヤーのサイズが縮小されます。 <em>distroless</em> の背後には、すべての要件 (場合によってはアプリケーション自体) を含む単一の最小限のベースイメージを使用するという考え方があります。</p>
</div>
<div class="paragraph">
<p>Quarkus は、<code>Dockerfile</code> で使用できる distroless ベースイメージを提供します。ユーザーは、アプリケーションをコピーするだけです:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM quay.io/quarkus/quarkus-distroless-image:1.0
COPY target/*-runner /application

EXPOSE 8080
USER nonroot

CMD ["./application", "-Dquarkus.http.host=0.0.0.0"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus は、<code>quay.io/quarkus/quarkus-distroless-image:1.0</code> イメージを提供します。ネイティブ実行可能ファイルを実行するために必要なパッケージが含まれており、サイズはほんの <strong>9Mb</strong> です。このイメージの上にアプリケーションを追加するだけで、小さなコンテナイメージを得ることができます。</p>
</div>
<div class="paragraph">
<p>Distroless イメージを本番環境で使用する場合は、必ず厳密なテストを実施してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="スクラッチベースイメージの使用"><a class="anchor" href="#スクラッチベースイメージの使用"></a>スクラッチベースイメージの使用</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
スクラッチベースイメージのサポートは実験的なものです。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>完全に静的にリンクされたバイナリをビルドすることで、ビルド結果のネイティブ実行ファイルのみを含む <a href="https://hub.docker.com/_/scratch">スクラッチイメージ</a> を使用することができます。</p>
</div>
<div class="paragraph">
<p>Sample multistage Dockerfile for building an image from <code>scratch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">## Stage 1 : build with maven builder image with native capabilities
FROM quay.io/quarkus/ubi-quarkus-native-image:22.0-java11 AS build
USER root
RUN microdnf install make gcc
COPY --chown=quarkus:quarkus mvnw /code/mvnw
COPY --chown=quarkus:quarkus .mvn /code/.mvn
COPY --chown=quarkus:quarkus pom.xml /code/
RUN mkdir /musl &amp;&amp; \
    curl -L -o musl.tar.gz https://more.musl.cc/10.2.1/x86_64-linux-musl/x86_64-linux-musl-native.tgz &amp;&amp; \
    tar -xvzf musl.tar.gz -C /musl --strip-components 1 &amp;&amp; \
    curl -L -o zlib.tar.gz https://zlib.net/zlib-1.2.12.tar.gz &amp;&amp; \
    mkdir zlib &amp;&amp; tar -xvzf zlib.tar.gz -C zlib --strip-components 1 &amp;&amp; \
    cd zlib &amp;&amp; ./configure --static --prefix=/musl &amp;&amp; \
    make &amp;&amp; make install &amp;&amp; \
    cd .. &amp;&amp; rm -rf zlib &amp;&amp; rm -f zlib.tar.gz &amp;&amp; rm -f musl.tar.gz
ENV PATH="/musl/bin:${PATH}"
USER quarkus
WORKDIR /code
RUN ./mvnw -B org.apache.maven.plugins:maven-dependency-plugin:3.1.2:go-offline
COPY src /code/src
RUN ./mvnw package -Pnative -Dquarkus.native.additional-build-args="--static","--libc=musl"

## Stage 2 : create the docker final image
FROM scratch
COPY --from=build /code/target/*-runner /application
ENTRYPOINT [ "/application" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>スクラッチイメージを本番環境で使用する場合は、必ず厳密なテストを実施してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="ネイティブ実行可能ファイルの圧縮"><a class="anchor" href="#ネイティブ実行可能ファイルの圧縮"></a>ネイティブ実行可能ファイルの圧縮</h3>
<div class="paragraph">
<p>Quarkus は、UPX を使用して生成されたネイティブ実行可能ファイルを圧縮できます。詳細については、<a href="./upx">UPX 圧縮のドキュメント</a> を参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="separating-java-and-native-image-compilation"><a class="anchor" href="#separating-java-and-native-image-compilation"></a>Separating Java and native image compilation</h3>
<div class="paragraph">
<p>特定の状況では、別のステップでネイティブイメージをビルドする必要がある場合もあります。たとえば、CI/CD パイプラインで、ネイティブイメージの生成に使用するソースを生成するステップと、これらのソースを使用して実際にネイティブ実行可能ファイルをビルドするステップを分けたい場合などです。このようなユースケースでは、<code>quarkus.package.type=native-sources</code> を設定できます。そうすることで、ネイティブコンパイル (<code>-Pnative</code>) を開始するように Java コンパイルを実行できますが、GraalVM の <code>native-image</code> の実際の呼び出しをトリガーする前に停止します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./mvnw clean package -Dquarkus.package.type=native-sources</code></pre>
</div>
</div>
<div class="paragraph">
<p>コンパイルが完了すると、ビルドアーティファクトが <code>target/native-sources</code> に表示されます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd target/native-sources
$ ls
native-image.args  getting-started-1.0.0-SNAPSHOT-runner.jar lib</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記の出力から、生成された jar ファイルと関連する lib ディレクトリに加えて、<code>native-image.args</code> という名前のテキストファイルが作成されたことがわかります。このファイルは、GraalVM の <code>native-image</code> コマンドに渡すすべてのパラメーター (コンパイルする JAR の名前を含む) を保持します。GraalVM がインストールされている場合は、以下を実行してネイティブコンパイルを開始できます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd target/native-source
$ native-image $(cat native-image.args)
...
$ ls
native-image.args
getting-started-1.0.0-SNAPSHOT-runner
getting-started-1.0.0-SNAPSHOT-runner.build_artifacts.txt
getting-started-1.0.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle のプロセスも同様です。</p>
</div>
<div class="paragraph">
<p>コンテナでビルドプロセスを実行することも可能です:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd target/native-image
docker run \
  -it \
  --rm \
  --v $(pwd):/work <i class="conum" data-value="1"></i><b>(1)</b>
  -w /work <i class="conum" data-value="2"></i><b>(2)</b>
  --entrypoint bin/sh \
  quay.io/quarkus/ubi-quarkus-native-image:22.0.0-java11 \ <i class="conum" data-value="3"></i><b>(3)</b>
  -c "native-image $(cat native-image.args) -J-Xmx4g" <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>ホストのディレクトリ <code>target/native-image</code> をコンテナの <code>/work</code> にマウントします。したがって、生成されたバイナリーもこのディレクトリに書き込まれます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>作業ディレクトリを、&lt;1&gt; でマウントした <code>/work</code> に切り替えます。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><a href="#multistage-docker">マルチステージDockerビルドの使用</a> で導入された <code>quay.io/quarkus/ubi-quarkus-native-image:22.0.0-java11</code> docker イメージを使用して、ネイティブイメージをビルドします。</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>ファイル <code>native-image.args</code> の内容を引数として <code>native-image</code> を呼び出します。また、プロセスの最大メモリーを 4 ギガバイトに制限するための追加の引数も提供します (これは、ビルドするプロジェクトとそれをビルドしているマシンにより異なります)。</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Windows マシンで実行している場合は、バイナリーが Linux docker コンテナ内で作成されていることに注意してください。つまり、バイナリーはホスト Windows マシンでは実行できません。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>CI/CD パイプラインのさまざまなステップがどのように見えるかについて、以下に概要を示しています。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>./mvnw &#8230;&#8203;</code> コマンドを実行するステップの出力 (つまり、ディレクトリ <code>target/native-image</code>) をビルドアーティファクトとして登録します。</p>
</li>
<li>
<p><code>native-image &#8230;&#8203;</code> コマンドを実行するステップでこのアーティファクトを要求し、</p>
</li>
<li>
<p><code>native-image &#8230;&#8203;</code> コマンドを実行するステップの出力 (つまり、<code>target/*runner</code> に一致するファイル) をビルドアーティファクトとして登録します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ステップ <code>1</code> を実行する環境には、Java と Maven (または Gradle) のみインストールされている必要がありますが、ステップ ` 3` を実行する環境には GraalVM のインストール (<code>native-image</code> 機能を含む) のみが必要です。</p>
</div>
<div class="paragraph">
<p>CI/CD パイプラインの最終的な出力に応じて、生成されたバイナリーがコンテナイメージの作成に使用されます。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ネイティブ実行可能ファイルのデバッグ"><a class="anchor" href="#ネイティブ実行可能ファイルのデバッグ"></a>ネイティブ実行可能ファイルのデバッグ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Oracle GraalVM 20.2 または Mandrel 20.1 から、Linux 環境用にネイティブ実行可能ファイルのデバッグシンボルを生成できるようになりました (Windowsのサポートは開発中、macOSはサポート対象外)。これらのシンボルは、<code>gdb</code> のようなツールを使用してネイティブ実行可能ファイルをデバッグするために使用できます。</p>
</div>
<div class="paragraph">
<p>デバッグシンボルを生成するには、ネイティブ実行可能ファイルの生成時に <code>-Dquarkus.native.debug.enabled=true</code> フラグを追加してください。ネイティブ実行可能ファイルのデバッグシンボルは、ネイティブ実行可能ファイルの隣にある <code>.debug</code> ファイルにあります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>.debug</code> ファイルの生成は <code>objcopy</code> に依存します。一般的な Linux ディストリビューションでは、<code>binutils</code> パッケージをインストールする必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># dnf (rpm-based)
sudo dnf install binutils
# Debian-based distributions
sudo apt-get install binutils</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>objcopy</code> が利用できない場合、デバッグシンボルが実行ファイルに埋め込まれています。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>デバッグシンボルとは別に、 <code>-Dquarkus.native.debug.enabled=true</code> フラグを設定すると、ネイティブ実行可能ファイル生成時に解決された JDK ランタイムクラス、GraalVM クラス、アプリケーションクラスのソースファイルのキャッシュが生成されます。このソースキャッシュは、シンボルと一致するソースコード間のリンクを確立するために、ネイティブデバッグツールにとって有用です。ネイティブ実行可能ファイルをデバッグする際に、必要なソースだけをデバッガー/IDEが利用できるようにする便利な方法を提供します。</p>
</div>
<div class="paragraph">
<p>Quarkusのソースコードを含むサードパーティのjar依存関係のソースは、デフォルトではソースキャッシュに追加されません。これらを含めるには、まず <code>mvn dependency:sources</code> を起動してください。このステップは、これらの依存関係のソースを引き出し、ソースキャッシュに含めるために必要です。</p>
</div>
<div class="paragraph">
<p>ソースキャッシュは <code>target/sources</code> フォルダーにあります。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>gdb</code> を <code>target</code> とは異なるディレクトリーから実行している場合、ソースは以下を</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">directory path/to/target</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>`gdb` プロンプトで実行することで読み込まれます。</pre>
</div>
</div>
<div class="paragraph">
<p>または、 <code>gdb</code> を以下のように起動してください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">gdb -ex 'directory path/to/target' path/to/target/{project.name}-{project.version}-runner</code></pre>
</div>
</div>
<div class="paragraph">
<p>e.g.,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">gdb -ex 'directory ./target' ./target/getting-started-1.0.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ネイティブイメージのデバッグに関する詳細なガイドについては、<a href="native-reference">ネイティブリファレンスガイド</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>ネイティブ実行可能ファイルの設定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ネイティブ実行可能ファイルの生成方法に影響を与える設定オプションがたくさんあります。これらは他の設定プロパティーと同じように <code>application.properties</code> で提供されています。</p>
</div>
<div class="paragraph">
<p>プロパティーは以下の通りです:</p>
</div>
<div class="paragraph configuration-legend">
<p><span class="icon"><i class="fa fa-lock" title="ビルド時に固定"></i></span> ビルド時に固定される設定プロパティ - それ以外の設定プロパティは実行時に上書き可能</p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><a id="quarkus-native-pkg-native-config_configuration"></a><a href="#quarkus-native-pkg-native-config_configuration">Configuration property</a></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">タイプ</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.additional-build-args"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.additional-build-args">quarkus.native.additional-build-args</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Comma-separated, additional arguments to pass to the build process. If an argument includes the <code>,</code> symbol, it needs to be escaped, e.g. <code>\\,</code></p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ADDITIONAL_BUILD_ARGS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-http-url-handler"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-http-url-handler">quarkus.native.enable-http-url-handler</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the HTTP url handler should be enabled, allowing you to do URL.openConnection() for HTTP URLs</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_HTTP_URL_HANDLER</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-https-url-handler"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-https-url-handler">quarkus.native.enable-https-url-handler</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the HTTPS url handler should be enabled, allowing you to do URL.openConnection() for HTTPS URLs</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_HTTPS_URL_HANDLER</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.headless"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.headless">quarkus.native.headless</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The default value for java.awt.headless JVM option. Switching this option affects linking of awt libraries.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_HEADLESS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.file-encoding"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.file-encoding">quarkus.native.file-encoding</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Defines the file encoding as in <code>-Dfile.encoding=&#8230;&#8203;</code>. Native image runtime uses the host&#8217;s (i.e. build time) value of <code>file.encoding</code> system property. We intentionally default this to UTF-8 to avoid platform specific defaults to be picked up which can then result in inconsistent behavior in the generated native executable.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_FILE_ENCODING</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>UTF-8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.add-all-charsets"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.add-all-charsets">quarkus.native.add-all-charsets</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If all character sets should be added to the native image. This increases image size</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ADD_ALL_CHARSETS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.graalvm-home"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.graalvm-home">quarkus.native.graalvm-home</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The location of the Graal distribution</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_GRAALVM_HOME</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>${GRAALVM_HOME:}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.java-home"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.java-home">quarkus.native.java-home</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The location of the JDK</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_JAVA_HOME</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html">File</a></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>${java.home}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.native-image-xmx"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.native-image-xmx">quarkus.native.native-image-xmx</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The maximum Java heap to be used during the native image generation</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_NATIVE_IMAGE_XMX</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.debug-build-process"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.debug-build-process">quarkus.native.debug-build-process</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the native image build should wait for a debugger to be attached before running. This is an advanced option and is generally only intended for those familiar with GraalVM internals</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_DEBUG_BUILD_PROCESS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.publish-debug-build-process-port"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.publish-debug-build-process-port">quarkus.native.publish-debug-build-process-port</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the debug port should be published when building with docker and debug-build-process is true</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_PUBLISH_DEBUG_BUILD_PROCESS_PORT</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-isolates"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-isolates">quarkus.native.enable-isolates</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If isolates should be enabled</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_ISOLATES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-fallback-images"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-fallback-images">quarkus.native.enable-fallback-images</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If a JVM based 'fallback image' should be created if native image fails. This is not recommended, as this is functionally the same as just running the application in a JVM</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_FALLBACK_IMAGES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.auto-service-loader-registration"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.auto-service-loader-registration">quarkus.native.auto-service-loader-registration</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If all META-INF/services entries should be automatically registered</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_AUTO_SERVICE_LOADER_REGISTRATION</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.dump-proxies"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.dump-proxies">quarkus.native.dump-proxies</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the bytecode of all proxies should be dumped for inspection</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_DUMP_PROXIES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.container-build"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.container-build">quarkus.native.container-build</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If this build should be done using a container runtime. Unless container-runtime is also set, docker will be used by default. If docker is not available or is an alias to podman, podman will be used instead as the default.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_CONTAINER_BUILD</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.remote-container-build"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.remote-container-build">quarkus.native.remote-container-build</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If this build is done using a remote docker daemon.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_REMOTE_CONTAINER_BUILD</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.builder-image"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.builder-image">quarkus.native.builder-image</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The docker image to use to do the image build. It can be one of <code>graalvm</code>, <code>mandrel</code>, or the full image path, e.g. <code>quay.io/quarkus/ubi-quarkus-mandrel:21.3-java17</code>.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_BUILDER_IMAGE</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>${platform.quarkus.native.builder-image}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.container-runtime"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.container-runtime">quarkus.native.container-runtime</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The container runtime (e.g. docker) that is used to do an image based build. If this is set then a container build is always done.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_CONTAINER_RUNTIME</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>docker</code>, <code>podman</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.container-runtime-options"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.container-runtime-options">quarkus.native.container-runtime-options</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Options to pass to the container runtime</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_CONTAINER_RUNTIME_OPTIONS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-vm-inspection"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-vm-inspection">quarkus.native.enable-vm-inspection</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the resulting image should allow VM introspection</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_VM_INSPECTION</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.full-stack-traces"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.full-stack-traces">quarkus.native.full-stack-traces</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If full stack traces are enabled in the resulting image</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_FULL_STACK_TRACES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-reports"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-reports">quarkus.native.enable-reports</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If the reports on call paths and included packages/classes/methods should be generated</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_REPORTS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.report-exception-stack-traces"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.report-exception-stack-traces">quarkus.native.report-exception-stack-traces</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If exceptions should be reported with a full stack trace</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_REPORT_EXCEPTION_STACK_TRACES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.report-errors-at-runtime"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.report-errors-at-runtime">quarkus.native.report-errors-at-runtime</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If errors should be reported at runtime. This is a more relaxed setting, however it is not recommended as it means your application may fail at runtime if an unsupported feature is used by accident.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_REPORT_ERRORS_AT_RUNTIME</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.reuse-existing"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.reuse-existing">quarkus.native.reuse-existing</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Don&#8217;t build a native image if it already exists. This is useful if you have already built an image and you want to use Quarkus to deploy it somewhere. Note that this is not able to detect if the existing image is outdated, if you have modified source or config and want a new image you must not use this flag.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_REUSE_EXISTING</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.resources.includes"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.resources.includes">quarkus.native.resources.includes</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>A comma separated list of globs to match resource paths that should be added to the native image.
 Use slash (<code>/</code>) as a path separator on all platforms. Globs must not start with slash.
 By default, no resources are included.
 Example: Given that you have <code>src/main/resources/ignored.png</code> and <code>src/main/resources/foo/selected.png</code> in your source tree and one of your dependency JARs contains <code>bar/some.txt</code> file, with the following configuration quarkus.native.resources.includes = foo/**,bar/**/*.txt  the files <code>src/main/resources/foo/selected.png</code> and <code>bar/some.txt</code> will be included in the native image, while <code>src/main/resources/ignored.png</code> will not be included.
 Supported glob features   Feature Description   <code>*</code> Matches a (possibly empty) sequence of characters that does not contain slash (<code>/</code>)   <code>**</code> Matches a (possibly empty) sequence of characters that may contain slash (<code>/</code>)   <code>?</code> Matches one character, but not slash   <code>[abc]</code> Matches one character given in the bracket, but not slash   <code>[a-z]</code> Matches one character from the range given in the bracket, but not slash   <code>[!abc]</code> Matches one character not named in the bracket; does not match slash   <code>[a-z]</code> Matches one character outside the range given in the bracket; does not match slash   <code>{one,two,three}</code> Matches any of the alternating tokens separated by comma; the tokens may contain wildcards, nested alternations and ranges   <code>\</code> The escape character
 Note that there are three levels of escaping when passing this option via <code>application.properties</code>:
 . <code>application.properties</code> parser
 - MicroProfile Config list converter that splits the comma separated list
 - Glob parser  All three levels use backslash (<code>\</code>) as the escaping character. So you need to use an appropriate number of backslashes depending on which level you want to escape.
 Note that Quarkus extensions typically include the resources they require by themselves. This option is useful in situations when the built-in functionality is not sufficient.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_RESOURCES_INCLUDES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.resources.excludes"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.resources.excludes">quarkus.native.resources.excludes</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>A comma separated list of globs to match resource paths that should <strong>not</strong> be added to the native image.
 Use slash (<code>/</code>) as a path separator on all platforms. Globs must not start with slash.
 Please refer to <code>includes</code> for details about the glob syntax.
 By default, no resources are excluded.
 Example: Given that you have <code>src/main/resources/red.png</code> and <code>src/main/resources/foo/green.png</code> in your source tree and one of your dependency JARs contains <code>bar/blue.png</code> file, with the following configuration quarkus.native.resources.includes = **/*.png quarkus.native.resources.excludes = foo/**,**/green.png  the resource <code>red.png</code> will be available in the native image while the resources <code>foo/green.png</code> and <code>bar/blue.png</code> will not be available in the native image.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_RESOURCES_EXCLUDES</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.debug.enabled"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.debug.enabled">quarkus.native.debug.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>If debug is enabled and debug symbols are generated. The symbols will be generated in a separate .debug file.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_DEBUG_ENABLED</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.enable-dashboard-dump"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.enable-dashboard-dump">quarkus.native.enable-dashboard-dump</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Generate the report files for GraalVM Dashboard.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_ENABLE_DASHBOARD_DUMP</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.compression.level"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.compression.level">quarkus.native.compression.level</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The compression level in [1, 10]. 10 means <strong>best</strong> Higher compression level requires more time to compress the executable.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_COMPRESSION_LEVEL</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-native-pkg-native-config_quarkus.native.compression.additional-args"></a><code><a href="#quarkus-native-pkg-native-config_quarkus.native.compression.additional-args">quarkus.native.compression.additional-args</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Allows passing extra arguments to the UPX command line (like --brute). The arguments are comma-separated. The exhaustive list of parameters can be found in <a href="https://github.com/upx/upx/blob/devel/doc/upx.pod">https://github.com/upx/upx/blob/devel/doc/upx.pod</a>.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code>QUARKUS_NATIVE_COMPRESSION_ADDITIONAL_ARGS</code></p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="次のステップ"><a class="anchor" href="#次のステップ"></a>次のステップ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドでは、アプリケーション用のネイティブ(バイナリー)実行ファイルの作成について説明しました。これにより、迅速な起動時間と少ないメモリー消費を示すアプリケーションを提供します。しかし、それだけではありません。</p>
</div>
<div class="paragraph">
<p><a href="deploying-to-kubernetes">Kubernetes と OpenShift へのデプロイメント</a> で探検を続けることをお勧めします。</p>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus はオープンです。このプロジェクトの全ての依存関係は<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>または互換性のあるライセンスの元で利用出来ます。<br /><br />このウェブサイトは <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築されており、<a href='https://pages.github.com/' target='_blank'>Github Pages</a>にホストされており、完全にオープンソースです。改善したい場合、 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォークし</a>、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
            <li><a href="/">ホーム</a></li>
          
            <li><a href="/about">Quarkusについて</a></li>
          
            <li><a href="/blog">ブログ</a></li>
          
            <li><a href="/insights">ポッドキャスト</a></li>
          
            <li><a href="/events">イベント</a></li>
          
            <li><a href="/newsletter">ニュースレター</a></li>
          
            <li><a href="/publications">出版</a></li>
          
            <li><a href="/awards">受賞</a></li>
          
            <li><a href="/security">セキュリティポリシー</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォロー</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Twitter</a></li>
          
            <li><a href="https://www.facebook.com/quarkusio">Facebook</a></li>
          
            <li><a href="https://www.linkedin.com/company/quarkusio/">Linkedin</a></li>
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg">Youtube</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
            <li><a href="/support">サポート</a></li>
          
            <li><a href="/guides">ガイド</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">入門</a></li>
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions">ディスカッション</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">開発メーリングリスト</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>言語</span>
        <ul class="footer-links">
          
            <li><a href="https://quarkus.io/">English</a></li>
          
            <li><a href="https://es.quarkus.io/">Español</a></li>
          
            <li><a href="https://cn.quarkus.io/">简体中文</a></li>
          
            <li><a href="https://ja.quarkus.io/">日本語</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">等々...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
</body>

</html>
